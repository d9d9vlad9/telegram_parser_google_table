# Scheduler Bot

**Scheduler Bot** — это Telegram-бот, который автоматически уведомляет о запланированных и текущих регламентных работах на основе данных из Google Sheets.  
Бот периодически проверяет расписание и отправляет сообщения в группу, чтобы ответственные сотрудники были вовремя оповещены.

---

## Функционал

- Чтение задач и сотрудников из Google Sheets  
- Автоматическое определение текущих активных задач по времени  
- Отправка уведомлений в Telegram-группу с упоминаниями ответственных  
- Логирование работы для удобства отладки и мониторинга

---

## Установка

1. Клонируйте репозиторий:  
```bash
git clone https://github.com/yourusername/scheduler-bot.git
cd scheduler-bot
```

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

3. Создайте файл .env и добавьте в него необходимые переменные (пример в .env.example):
```bash
BOT_TOKEN=ваш_токен_бота
GROUP_ID=ваш_id_группы_в_телеграм
SPREADSHEET_ID=ID_вашей_таблицы_в_Google_Sheets
CREDENTIALS_FILE=credentials.json
CHECK_INTERVAL=60
LOG_LEVEL=DEBUG
```

4. Поместите файл с учетными данными Google API (credentials.json) в корень проекта.

## Конфигурация

Для работы бота необходимо настроить файл `.env` с необходимыми параметрами:

```env
# Токен Telegram-бота
BOT_TOKEN=ваш_токен_бота

# ID Telegram-группы, куда будут отправляться уведомления
GROUP_ID=ваш_group_id

# ID Google Таблицы с задачами
SPREADSHEET_ID=ваш_spreadsheet_id

# Путь к файлу с учетными данными для доступа к Google API
CREDENTIALS_FILE=credentials.json

# Интервал проверки задач в секундах (например, 60)
CHECK_INTERVAL=60

# Уровень логирования (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=DEBUG
```

## Запуск
Запустите бота командой:
```bash
python main.py
```
Бот начнет работу, отправит приветственное сообщение и будет регулярно проверять задачи,\
отправляя уведомления о текущих и запланированных регламентных работах.

## Структура проекта
```bash
app/
├── bot.py               # Инициализация и настройка Telegram-бота (aiogram)
├── config.py            # Конфигурационные параметры и константы проекта
├── employee_notifier.py # Логика формирования упоминаний сотрудников для уведомлений
├── get_active_task.py   # Получение активных задач из таблицы по текущему времени
├── notifier.py          # Модуль для отправки сообщений через Telegram-бота
├── scheduler.py         # Планировщик задач, проверяющий расписание и отправляющий уведомления
├── sheets_service.py    # Работа с Google Sheets API через библиотеку gspread
├── task_processor.py    # Фильтрация и группировка задач для уведомлений
├── main.py              # Точка входа приложения (запуск бота и планировщика)
└── __init__.py          # Позволяет считать папку модулем Python

.env                    # Файл с переменными окружения (токены, ID и пр.)
requirements.txt        # Список зависимостей Python проекта
README.md               # Документация проекта
```
